<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[破解x-pack]]></title>
      <url>/2017/11/28/%E7%A0%B4%E8%A7%A3x-pack/</url>
      <content type="html"><![CDATA[<h1 id="x-pack-安装步骤如下"><a href="#x-pack-安装步骤如下" class="headerlink" title="x-pack 安装步骤如下:"></a>x-pack 安装步骤如下:</h1><h3 id="1-在ES5-0安装-X-PACK"><a href="#1-在ES5-0安装-X-PACK" class="headerlink" title="1.在ES5.0安装 X-PACK"></a>1.在ES5.0安装 X-PACK</h3><p>bin/elasticsearch-plugin install x-pack</p>
<p>如果不需要该插件，也可以通过非常简单的方式删除：</p>
<p>bin/elasticsearch-plugin remove x-pack</p>
<a id="more"></a>
<h3 id="2-在kibana5-0中安装X-PACK"><a href="#2-在kibana5-0中安装X-PACK" class="headerlink" title="2.在kibana5.0中安装X-PACK"></a>2.在kibana5.0中安装X-PACK</h3><p>bin/kibana-plugin install x-pack</p>
<p>卸载：bin/kibana-plugin remove x-pack</p>
<p>安装成功后重启ElasticSearch和Kibana：</p>
<p>以上安装之后，就会发现ES的访问和Kibana的访问都受到限制</p>
<p>默认的用户名和密码：</p>
<p>用户名：elastic</p>
<p>密码：changeme</p>
<p>登录到Kibana会发现 elastic是一个最高级别的user，拥有所有权限，其角色是superuser。</p>
<p>elasticsearch和kibana默认是受限可一修改配置文件来取消限制。具体参见 ：<a href="https://www.elastic.co/guide/en/x-pack/current/installing-xpack.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/x-pack/current/installing-xpack.html</a></p>
<p>登录时不让输入用户和密码，提示license不允许，免费的license只有一年时间，找了一下,可以破解，步骤如下：</p>
<h5 id="1-破解并安装"><a href="#1-破解并安装" class="headerlink" title="1: 破解并安装"></a>1: 破解并安装</h5><p>下载x-pack-5.2.0.zip，</p>
<p>解压并找到x-pack-5.2.0.jar。这里使用JD-GUI是无法反编译的，</p>
<p>我使用的是Luyten(下载地址：<a href="https://github.com/deathmarine/Luyten/releases/tag/v0.5.0）进行反编译。" target="_blank" rel="noopener">https://github.com/deathmarine/Luyten/releases/tag/v0.5.0）进行反编译。</a></p>
<p>将org.elasticsearch/license/LicenseVerifier.class反编译并保存出来。这个类是检查license完整性的类，我们使其始终返回true，就可以任意修改license并导入。将其改为：</p>
<p>package org.elasticsearch.license;</p>
<p><code>import java.nio.*;</code></p>
<p><code>import java.util.*;</code></p>
<p><code>import java.security.*;</code></p>
<p><code>import org.elasticsearch.common.xcontent.*;</code></p>
<p><code>import org.apache.lucene.util.*;</code></p>
<p><code>import org.elasticsearch.common.io.*;</code></p>
<p><code>import java.io.*;</code></p>
<p><code>public class LicenseVerifier</code></p>
<p><code>{</code></p>
<p><code>public static boolean verifyLicense(final License license, final byte[] encryptedPublicKeyData) {</code></p>
<p><code>return true;</code></p>
<p><code>}</code></p>
<p><code>public static boolean verifyLicense(final License license) {</code></p>
<p><code>return true;</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p>注：红色的部分可以都不要</p>
<p>然后需要重新编译class文件。注意这里我们无需编译整个工程，将原来的x-pack-5.2.0.jar和依赖包加入CLASSPATH，即可完成单个文件的编译。实际上只用到了3个依赖包，如果是用RPM或DEB安装的，直接运行：</p>
<p>javac -cp “e:/tools/linux/elasticsearch/5.0/elasticsearch-5.0.0.jar;e:/tools/linux/elasticsearch/5.0/lucene-core-6.2.0.jar;E:/tools/linux/elasticsearch/5.0/x-pack-5.0.0/elasticsearch/x-pack-5.0.0.jar” LicenseVerifier.java</p>
<p>注：javac执行时的参数cp 表示classpath 路径，如果多个在windows环境中用 ; 隔开，linux中用 : 隔开；</p>
<p>把x-pack-5.2.0.jar用压缩文件管理器打开，将里面的LicenseVerifier.class替换掉。再把破解了的jar包部署到各节点上，</p>
<p>将破解的.zip文件安装到服务器,启动 elasticsearch,kibana，并重启集群。安装新的之前要现将已经安装的删除。</p>
<p>./bin/elasticsearch-plugin remove x-pack</p>
<p>./bin/elasticsearch-plugin install file:///srv/x-pack-5.4.1.zip</p>
<p>./bin/kibana-plugin install file:///srv/x-pack-5.4.1.zip</p>
<p>申请一个免费license(<a href="https://license.elastic.co/registration" target="_blank" rel="noopener">https://license.elastic.co/registration</a>) 注册后可以下载文件,下载后修改，例如：</p>
<p>主要修改：type改为platinum表示可以使用所有功能 ; expiry_date_in<em>millis  我这里改了10年 ^</em>^</p>
<p><code>{&quot;license&quot;:{&quot;uid&quot;:&quot;10cf8263-4d23-4e81-b10b-95abfb14b599&quot;,&quot;type&quot;:&quot;platinum&quot;,&quot;issue_date_in_millis&quot;:1490832000000,&quot;expiry_date_in_millis&quot;:1806237751991,&quot;max_nodes&quot;:100,&quot;issued_to&quot;:&quot;www bbb (baiye)&quot;,&quot;issuer&quot;:&quot;Web Form&quot;,&quot;signature&quot;:&quot;+2yc0QcB&quot;,&quot;start_date_in_millis&quot;:1490832000000}}</code></p>
<p>``【安装license】</p>
<p>查看当前的license</p>
<p><code>[root@localhost Downloads]# curl -XGET -u elastic:changeme &#39;http://192.168.100.50:9200/_license&#39;</code></p>
<p>将编辑好的license.json文件放到服务器，在文件目录下执行：</p>
<p><code>[root@localhost Downloads]#curl -XPUT -u elastic:changeme &#39;http://192.168.100.50:9200/_xpack/license&#39; -d @license.json</code></p>
<p>或者下面：</p>
<p><code>[root@localhost Downloads]#curl -XPUT -u elastic:changeme &#39;http://192.168.100.50:9200/_xpack/license?acknowledge=true&#39; -d @license.json</code></p>
<p>重启elasticsearch和kibana .</p>
<p>打开：<a href="http://192.168.100.50:5601/login" target="_blank" rel="noopener">http://192.168.100.50:5601/login</a>  可正常登录。</p>
<p> <img src="/Users/liukaizhao/Downloads/headImg.jpeg" alt="headImg"></p>
]]></content>
      
        <categories>
            
            <category> ELK </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ELK </tag>
            
            <tag> 数据 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2017/11/28/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><a id="more"></a>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      
        
    </entry>
    
  
  
</search>
